<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<meta name="format-detection" content="telephone=no" />
	<meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">
	<script type="text/javascript" src="js/setviewport1080.js" ></script>
	<script type="text/javascript" src="js/jquery-1.11.1.min.js" ></script>
	<link rel="stylesheet" href="css/head&bottom-d.css" />
	<link rel="stylesheet" href="css/transfer-zone.css" />
	<script type="text/javascript" src="js/iscroll.js" ></script>
	<title>易转宝转让专区</title>
</head>
<body>
	<div class="tra-r-mgbox">
		<!--头部-->
		<div class="title2-1080">
            <a href="financeList.do" class="title_left1080">
                <img src="img/bk-c-return-g.png">
            </a>
            <span>易转宝转让专区</span>
        </div>	
        <!--切换 tra-qh-->
        <ul class="tra-z-qhtxto">
        	<li class="tra-qh fl">
        		<a class="tra-z-qhtxta" href="javascript:;">转让中</a>
        		<i></i>
        	</li>
        	<li class="fl">
        		<a class="tra-z-qhtxta" href="javascript:;">已转让</a>	
        		<i></i>
        	</li>
					
		</ul>
				
        <!--切换的内容-->
		<div class="tra-z-qhcontent" id="wrapper">
			<!--转让中  没记录 加no-recoo  已转让  没记录  加no-recoo2-->	
			<div class="inv-recoi" >
				<div id="pullDown">
					<div class="refresh-box">
						<span class="pullDownIcon loading-ico"></span>
						<span class="pullDownLabel">下拉可以刷新</span>
					</div>
				</div>
				<!--有记录-->	
				<!--没记录 加 in-tra-->
				<ul class="has-reci">
					<!--数据-->
					<li class="tra-z-sjo">
						<a class="tra-z-sj" href="javascript:;">
							<div class="tra-z-t">
								<span class="tra-z-ta fl">易转宝转让第50期</span>	
								<div class="tra-z-tb fr">
									<i></i>	
									<span>华兴银行存管</span>
								</div>
							</div>	
							<div class="tra-z-m">
								<div class="tra-z-m1 fl">
									<p class="tra-z-m1a">7.5%+9.8%</p>
									<p class="tra-z-m1b">预期年化收益率</p>
								</div>	
								<span class="tra-z-line1"></span>
								<div class="tra-z-m2 fl">
									<p class="tra-z-m1a">40</p>
									<p class="tra-z-m1b">剩余期限(天)</p>	
								</div>
								<span class="tra-z-line1"></span>
								<div class="tra-z-m1 fr">
									<p class="tra-z-m1a">9000000.00</p>
									<p class="tra-z-m1b">转让金额(元)</p>	
								</div>
							</div>
						</a>	
					</li>
					<!--数据-->
					<li class="tra-z-sjo">
						<a class="tra-z-sj" href="javascript:;">
							<div class="tra-z-t">
								<span class="tra-z-ta fl">易转宝转让第50期</span>	
								<div class="tra-z-tb fr">
									<i></i>	
									<span>华兴银行存管</span>
								</div>
							</div>	
							<div class="tra-z-m">
								<div class="tra-z-m1 fl">
									<p class="tra-z-m1a">7.5%+9.8%</p>
									<p class="tra-z-m1b">预期年化收益率</p>
								</div>	
								<span class="tra-z-line1"></span>
								<div class="tra-z-m2 fl">
									<p class="tra-z-m1a">40</p>
									<p class="tra-z-m1b">剩余期限(天)</p>	
								</div>
								<span class="tra-z-line1"></span>
								<div class="tra-z-m1 fr">
									<p class="tra-z-m1a">9000000.00</p>
									<p class="tra-z-m1b">转让金额(元)</p>	
								</div>
							</div>
						</a>	
					</li>					
					<!--没记录-->
					<div class="no-reco">
						<div class="tra-z-nr">
							<img src="img/ttbp-noreco.png">	
						</div>
						<p class="tra-z-nr-txt1">暂无购买记录</p>
					</div>
				</ul>
				<!--没记录 加  been-tra-->
				<ul class="has-reci been-tra" style="display:none;">
					<!--数据-->
					<li class="tra-z-sjo">
						<a class="tra-z-sj" href="javascript:;">
							<div class="tra-z-t">
								<span class="tra-z-ta fl">易转宝转让第50期</span>	
								<div class="tra-z-tb fr">
									<i></i>	
									<span>华兴银行存管</span>
								</div>
							</div>	
							<div class="tra-z-m">
								<div class="tra-z-m1 fl">
									<p class="tra-z-m1a">7.5%+9.8%</p>
									<p class="tra-z-m1b">预期年化收益率</p>
								</div>	
								<span class="tra-z-line1"></span>
								<div class="tra-z-m2 fl">
									<p class="tra-z-m1a">40</p>
									<p class="tra-z-m1b">剩余期限(天)</p>	
								</div>
								<span class="tra-z-line1"></span>
								<div class="tra-z-m1 fr">
									<p class="tra-z-m1a">9000000.00</p>
									<p class="tra-z-m1b">转让金额(元)</p>	
								</div>
							</div>
						</a>	
					</li>					
					<!--没记录-->
					<div class="no-reco2">
						<div class="tra-z-nr">
							<img src="img/ttbp-noreco.png">	
						</div>
						<p class="tra-z-nr-txt1">暂无购买记录</p>
					</div>
				
				
				</ul>
					
															
				<div id="pullUp" style="display:none;">
					<div class="refresh-box">
						<span class="pullUpIcon loading-ico"></span>
						<span class="pullUpLabel">上拉加载更多</span>
					</div>
				</div>
					
					
				
			</div>
			
			
		</div>	
	
        	
		
	</div>	
</body>
<script>
	document.addEventListener('touchstart',function(){},false);	
	
</script>
<script>
			
	$(document).ready(function(){
		var clientHeight = $("html")[0].clientHeight;
    $(".tra-r-mgbox").css("min-height",(clientHeight));
　　})			
</script>

<script type="text/javascript">

$('.tra-z-qhtxto li').on('click',function(){
    var $this = $(this);
    itemIndex = $this.index();
    $this.addClass('tra-qh').siblings('li').removeClass('tra-qh');
    $('.has-reci').eq(itemIndex).show().animate({'opacity':1},300).siblings('.has-reci').hide().animate({'opacity':0},300);
    myScroll.scrollTo(0, 0);
	myScroll.refresh();
});
//下拉滚动，上拉加载
var myScroll,
	pullDownEl, 
	pullDownOffset,
	pullUpEl, 
	pullUpOffset;


function pullDownAction () {
	setTimeout(function () {
		myScroll.refresh();
	}, 1000);
}

function pullUpAction () {
	setTimeout(function () {
		$.ajax({
                type: 'GET',
                url: 'json/more2.json',
                dataType: 'json',
                success: function(data){
                    var result = '';
                    for(var i = 0; i < data.lists.length; i++){
                        result +=   '<li class="tra-z-sjo"><a class="tra-z-sj" href="'+data.lists[i].surl+'">'
                                        +'<div class="tra-z-t">'
											+'<span class="tra-z-ta fl">易转宝转让第'+data.lists[i].periods+'期</span>'	
											+'<div class="tra-z-tb fr">'
												+'<i></i>'	
												+'<span>华兴银行存管</span>'
											+'</div>'
										+'</div>'
                                        +'<div class="tra-z-m">'
											+'<div class="tra-z-m1 fl">'
												+'<p class="tra-z-m1a">'+data.lists[i].yield1+'%+'+data.lists[i].yield2+'%</p>'
												+'<p class="tra-z-m1b">预期年化收益率</p>'
											+'</div>'	
											+'<span class="tra-z-line1"></span>'
											+'<div class="tra-z-m2 fl">'
												+'<p class="tra-z-m1a">'+data.lists[i].days+'</p>'
												+'<p class="tra-z-m1b">剩余期限(天)</p>'	
											+'</div>'
											+'<span class="tra-z-line1"></span>'
											+'<div class="tra-z-m1 fr">'
												+'<p class="tra-z-m1a">'+data.lists[i].money+'</p>'
												+'<p class="tra-z-m1b">转让金额(元)</p>'	
											+'</div>'
										+'</div>'
                                        +'</a></li>';
                    }
                    
                    
						
								
							
						
                    
                    
                    
                    // 为了测试，延迟1秒加载
                    setTimeout(function(){
                    	var el, li, i, curIndex;
						el = document.getElementsByTagName('ul');
						curIndex = $(".tra-qh").index();
						
                        $(".inv-recoi ul").eq(curIndex).append(result);
                        // 每次数据加载完，必须重置
                        myScroll.refresh();
                    },1000);
                },
                error: function(xhr, type){
                    alert('Ajax error!');
                    // 即使加载出错，也得重置
                    myScroll.refresh();
                }
            });



		myScroll.refresh();
	}, 1000);
}

function loaded() {
	pullDownEl = document.getElementById('pullDown');
	pullDownOffset = pullDownEl.offsetHeight;
	pullUpEl = document.getElementById('pullUp');	
	pullUpOffset = pullUpEl.offsetHeight;
	myScroll = new iScroll('wrapper', {
		useTransition: true,
		topOffset: pullDownOffset,
		onRefresh: function () {
			if (pullDownEl.className.match('loading')) {
				pullDownEl.className = '';
				pullDownEl.querySelector('.pullDownLabel').innerHTML = '下拉可以刷新';
			} else if (pullUpEl.className.match('loading')) {
				pullUpEl.className = '';
				pullUpEl.querySelector('.pullUpLabel').innerHTML = '上拉加载更多';
			}
		},
		onScrollMove: function () {
			if (this.y > 5 && !pullDownEl.className.match('flip')) {
				pullDownEl.className = 'flip';
				pullDownEl.querySelector('.pullDownLabel').innerHTML = '松开立即刷新';
				this.minScrollY = 0;
			} else if (this.y < 5 && pullDownEl.className.match('flip')) {
				pullDownEl.className = '';
				pullDownEl.querySelector('.pullDownLabel').innerHTML = '下拉可以刷新';
				this.minScrollY = -pullDownOffset;
			} else if ( this.scrollerH < this.wrapperH && this.y < (this.minScrollY-pullUpOffset) || this.scrollerH > this.wrapperH && this.y < (this.maxScrollY - pullUpOffset) ) {
				pullUpEl.className = 'flip';	
				document.getElementById("pullUp").style.display="";		
				pullUpEl.querySelector('.pullUpLabel').innerHTML = '上拉加载更多';
				this.maxScrollY = this.maxScrollY;
			} else if (this.y > (this.maxScrollY + 5) && pullUpEl.className.match('flip')) {
				pullUpEl.className = '';
				document.getElementById("pullUp").style.display="";		
				pullUpEl.querySelector('.pullUpLabel').innerHTML = '上拉加载更多';
				this.maxScrollY = pullUpOffset;
			}
		},
		onScrollEnd: function () {

			if (pullDownEl.className.match('flip')) {
				pullDownEl.className = 'loading';
				pullDownEl.querySelector('.pullDownLabel').innerHTML = '正在刷新数据中…';	
				pullDownAction();
			} else if (pullUpEl.className.match('flip')) {
				pullUpEl.className = 'loading';	
				pullUpEl.querySelector('.pullUpLabel').innerHTML = '正在加载更多的数据…';
				pullUpAction();	
				setTimeout(function () {document.getElementById("pullUp").style.display="none";	},1000);
			}
		}
	});
	
}

document.addEventListener('touchmove', function (e) { e.preventDefault(); }, false);

document.addEventListener('DOMContentLoaded', function () { setTimeout(loaded, 100); }, false);
</script>	



</html>
